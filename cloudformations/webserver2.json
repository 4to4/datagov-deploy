{  
   "AWSTemplateFormatVersion":"2010-09-09",
   "Description":"catalog-deploy ec2 stack",
   "Resources":{  
      "EC2Instance":{  
         "Type":"AWS::EC2::Instance",
         "Properties":{  
            "AvailabilityZone":"us-east-1",
            "BlockDeviceMappings":[  
               {  
                  "DeviceName":"/dev/sda1",
                  "Ebs":{  
                     "DeleteOnTermination":"false",
                     "VolumeSize":"20",
                     "VolumeType":"gp2",
                     "SnapshotId":"snap-catalog-deploy"
                  }
               }
            ],
            "ImageId":"ami-45826e2e",
            "InstanceType":"m3.medium",
            "KeyName":"ckan-csw-aws",
            "SecurityGroups":[  
               {  
                  "Ref":"CatalogDeploySecurityGroup"
               }
            ],
            "Tags":[  
               {  
                  "Key":"name",
                  "Value":"catalog-deploy"
               },
               {  
                  "Key":"owner",
                  "Value":"dan.olaru"
               }
            ]
         }
      },
      "CatalogDeploySecurityGroup":{  
         "Type":"AWS::EC2::SecurityGroup",
         "Properties":{  
            "GroupDescription":"Security group for Catalog Deploy ckan web server",
            "SecurityGroupIngress":[  
               {  
                  "IpProtocol":"tcp",
                  "FromPort":"80",
                  "ToPort":"80",
                  "CidrIp":"0.0.0.0/0"
               },
               {  
                  "IpProtocol":"tcp",
                  "FromPort":"22",
                  "ToPort":"22",
                  "CidrIp":"65.242.97.254/32"
               }
            ]
         }
      },
      "IPAssoc":{  
         "Type":"AWS::EC2::EIPAssociation",
         "Properties":{  
            "InstanceId":{  
               "Ref":"EC2Instance"
            },
            "EIP":"54.243.131.201"
         }
      }
   }
}
